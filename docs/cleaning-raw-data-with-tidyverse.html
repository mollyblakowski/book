<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Cleaning raw data with tidyverse | Investigating industrial sources of heavy metal pollution to the Great Salt Lake playa</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Cleaning raw data with tidyverse | Investigating industrial sources of heavy metal pollution to the Great Salt Lake playa" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Cleaning raw data with tidyverse | Investigating industrial sources of heavy metal pollution to the Great Salt Lake playa" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Molly Blakowski" />


<meta name="date" content="2021-04-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="plotting-data-with-ggplot.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">WILD 6900 Final Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#project-goals"><i class="fa fa-check"></i><b>1.1</b> Project goals</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#project-outline"><i class="fa fa-check"></i><b>1.2</b> Project outline</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#project-background"><i class="fa fa-check"></i><b>1.3</b> Project background</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cleaning-raw-data-with-tidyverse.html"><a href="cleaning-raw-data-with-tidyverse.html"><i class="fa fa-check"></i><b>2</b> Cleaning raw data with tidyverse</a></li>
<li class="chapter" data-level="3" data-path="plotting-data-with-ggplot.html"><a href="plotting-data-with-ggplot.html"><i class="fa fa-check"></i><b>3</b> Plotting data with ggplot</a></li>
<li class="chapter" data-level="4" data-path="creating-a-database-in-sqlite.html"><a href="creating-a-database-in-sqlite.html"><i class="fa fa-check"></i><b>4</b> Creating a database in SQLite</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Investigating industrial sources of heavy metal pollution to the Great Salt Lake playa</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cleaning-raw-data-with-tidyverse" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Cleaning raw data with tidyverse</h1>
<p>Elemental and <span class="math inline">\(\epsilon\)</span><sup>205</sup>Tl data were shared with me in Excel workbooks that required some cleaning. At first, I edited the sheets manually and recorded all changes in a README file, but that didnâ€™t seem like the best practice moving forward. Thankfully, <a href="https://scholar.google.com/citations?user=ATH-XT0AAAAJ&amp;hl=en">my partner</a> is a wonderful programmar and was kind enough to help make these changes programmatically. Here are the packages we used to clean the data:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># load packages</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(readxl)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(mgsub)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(lubridate)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">library</span>(devtools)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">library</span>(matrixStats)</a></code></pre></div>
<p>With the appropriate packages ready to go, I loaded in the data from two different workbooks.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># load data</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">setwd</span>(<span class="st">&quot;/Users/mollyblakowski/Documents/professional/PhD/research/book&quot;</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">iso &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;GSLdust2019_isotopes.xlsx&quot;</span>, <span class="dt">sheet=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">el &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;GSLdust2019_elements.xlsx&quot;</span>, <span class="dt">sheet=</span><span class="dv">1</span>)</a></code></pre></div>
<p>Originally, the <span class="math inline">\(\epsilon\)</span><sup>205</sup>Tl data was split into multiple run columns because my collaborator ran the MC-ICP-MS on a few different days, with multiple runs per sample for quality assurance. I didnâ€™t need all of the columns and rows on this original spreadsheet. I also needed to make sure that the column names were readable (e.g., no merged columns) and specify that the data are numeric rather than characters. My collaborator had calculated 2SD in Excel, but I wanted to do this programmatically as well, so I used matrixStats to get means and SDs from the multiple runs. Last, I wanted to rename the samples and add in a column for the month of the sampling period. This wasnâ€™t exactly a piece of cake, but it works!</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># clean isotope sheet</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">iso_clean &lt;-<span class="st"> </span>iso <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span><span class="op">:</span><span class="dv">24</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># select needed columns</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">  </span><span class="kw">slice</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">35</span>,<span class="op">-</span><span class="dv">36</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># slice out unneeded rows</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="st">  `</span><span class="dt">colnames&lt;-</span><span class="st">`</span>(<span class="kw">c</span>(<span class="st">&quot;sample&quot;</span>, <span class="kw">paste0</span>(<span class="st">&quot;data&quot;</span>,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">18</span>)))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># make column names readable</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>), as.numeric)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># specify that data are numeric</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mean =</span> <span class="kw">rowMeans</span>(.[,<span class="dv">2</span><span class="op">:</span><span class="dv">18</span>], <span class="dt">na.rm=</span>T), </a>
<a class="sourceLine" id="cb3-9" data-line-number="9">         <span class="dt">sd =</span> matrixStats<span class="op">::</span><span class="kw">rowSds</span>(<span class="kw">as.matrix</span>(.[,<span class="dv">2</span><span class="op">:</span><span class="dv">18</span>]), <span class="dt">na.rm=</span>T)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># calculate means and SDs</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sd2 =</span> sd<span class="op">*</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># calculate 2SD</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">date =</span> <span class="kw">gsub</span>(<span class="st">&quot;_.*&quot;</span>, <span class="st">&quot;&quot;</span>, sample),</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">         <span class="dt">name =</span> <span class="kw">gsub</span>(<span class="st">&quot;.*_(.*)_.*&quot;</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&quot;</span>, sample),</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">         <span class="dt">height =</span> <span class="kw">gsub</span>(<span class="st">&quot;.*_&quot;</span>, <span class="st">&quot;&quot;</span>, sample)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># pull out date number and name character</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">month =</span> <span class="kw">month</span>(<span class="kw">as.numeric</span>(<span class="kw">substr</span>(date,<span class="dv">1</span>,<span class="dv">2</span>)), <span class="dt">label=</span>T, <span class="dt">abbr=</span>F),</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">         <span class="dt">name_short =</span> <span class="kw">mgsub</span>(name, <span class="kw">c</span>(<span class="st">&quot;ANT&quot;</span>, <span class="st">&quot;SYR&quot;</span>, <span class="st">&quot;KAYS&quot;</span>, <span class="st">&quot;LAYT&quot;</span>, <span class="st">&quot;FARM&quot;</span>), </a>
<a class="sourceLine" id="cb3-16" data-line-number="16">                            <span class="kw">c</span>(<span class="st">&quot;AP&quot;</span>, <span class="st">&quot;SP&quot;</span>, <span class="st">&quot;KP&quot;</span>, <span class="st">&quot;LP&quot;</span>, <span class="st">&quot;FP&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># rename samples</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(name_short, month, height, mean, sd2) <span class="co"># select just desired columns</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="kw">write.csv</span>(iso_clean, <span class="st">&quot;isotopes_summary.csv&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>) <span class="co"># save a nice csv file</span></a></code></pre></div>
<p>Processing the elemental data sheet was a little easier because there werenâ€™t multiple runs for each sample. So, as with the isotope data, I selected the columns and rows that I needed, changed the sample name format, and added a column for month. I also converted all elements to ppm instead of ppb, turned OR (out of range) data into NA, and adjusted &lt;0.000 to 0. Last, I removed some extra information from the column names, i.e., whether or not He gas was used for the measurements.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># clean element sheet</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">el_clean &lt;-<span class="st"> </span>el <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span>(<span class="kw">dim</span>(el)[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># select needed columns</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>), <span class="cf">function</span>(.)<span class="kw">mgsub</span>(., <span class="kw">c</span>(<span class="st">&quot;OR&quot;</span>, <span class="st">&quot;&lt;0.000&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;NA&quot;</span>, <span class="st">&quot;0&quot;</span>)))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>), as.numeric)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>), <span class="cf">function</span>(.).<span class="op">/</span><span class="dv">1000</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sample =</span> ...<span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="st">  </span><span class="kw">slice</span>(<span class="kw">c</span>(<span class="dv">8</span><span class="op">:</span><span class="dv">40</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># getting rid of unwanted rows</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">date =</span> <span class="kw">gsub</span>(<span class="st">&quot;_.*&quot;</span>, <span class="st">&quot;&quot;</span>, sample),</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">         <span class="dt">name =</span> <span class="kw">gsub</span>(<span class="st">&quot;.*_(.*)_.*&quot;</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&quot;</span>, sample),</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">         <span class="dt">height =</span> <span class="kw">gsub</span>(<span class="st">&quot;.*_&quot;</span>, <span class="st">&quot;&quot;</span>, sample)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># pull out date number and name character</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">month =</span> <span class="kw">month</span>(<span class="kw">as.numeric</span>(<span class="kw">substr</span>(date,<span class="dv">1</span>,<span class="dv">2</span>)), <span class="dt">label=</span>T, <span class="dt">abbr=</span>F),</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">         <span class="dt">name_short =</span> <span class="kw">mgsub</span>(name, <span class="kw">c</span>(<span class="st">&quot;ANT&quot;</span>, <span class="st">&quot;SYR&quot;</span>, <span class="st">&quot;KAYS&quot;</span>, <span class="st">&quot;LAYT&quot;</span>, <span class="st">&quot;FARM&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;AP&quot;</span>, <span class="st">&quot;SP&quot;</span>, <span class="st">&quot;KP&quot;</span>, <span class="st">&quot;LP&quot;</span>, <span class="st">&quot;FP&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="st">  `</span><span class="dt">colnames&lt;-</span><span class="st">`</span>(<span class="kw">gsub</span>(<span class="st">&quot; </span><span class="ch">\\</span><span class="st">[ .* </span><span class="ch">\\</span><span class="st">]&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="kw">colnames</span>(.))) <span class="co"># get rid of [ No gas ] and [ He ]</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="kw">write.csv</span>(el_clean, <span class="st">&quot;elements_summary.csv&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>) <span class="co"># save a nice, clean csv file</span></a></code></pre></div>
<p>Last, I pulled just the Tl concentrations from the elemental data sheet and made a new sheet combining them with the <span class="math inline">\(\epsilon\)</span><sup>205</sup>Tl data. I created an additional column called combined_names because I wanted to plot the three sites that are periodically flooded with water from the Jordan river in one group to compare with samples from the other two sites that do not experience flooding.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># subset to plot Tl</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">tl_subset &lt;-<span class="st"> </span>el_clean <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(name_short, month, height, <span class="st">`</span><span class="dt">205  Tl </span><span class="st">`</span>) <span class="co"># pull just Tl data</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="kw">write.csv</span>(tl_subset, <span class="st">&quot;elements_Tl.csv&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>) <span class="co"># make Tl concentrations sheet</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"></a>
<a class="sourceLine" id="cb5-8" data-line-number="8">iso_el &lt;-<span class="st"> </span><span class="kw">left_join</span>(iso_clean, tl_subset, <span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;name_short&quot;</span>, <span class="st">&quot;month&quot;</span>, <span class="st">&quot;height&quot;</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># combine tl_subset w/ iso_clean</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Tl_inv =</span> <span class="dv">1</span><span class="op">/</span><span class="st">`</span><span class="dt">205  Tl </span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># but with inverted Tl concentrations</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">combined_names =</span> <span class="kw">ifelse</span>(name_short <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;LP&quot;</span>, <span class="st">&quot;KP&quot;</span>, <span class="st">&quot;FP&quot;</span>), <span class="st">&quot;LP, KP, and FP&quot;</span>, name_short)) <span class="co"># combine flooded sites</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="kw">write.csv</span>(iso_el, <span class="st">&quot;merged_data.csv&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre></div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotting-data-with-ggplot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book.pdf", "book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
